{"Name":"Dynamic Folder Export","Objects":[{"Type":"DynamicFolder","Name":"CSV (PowerShell)","Description": "This Dynamic Folder sample for CSV files allows you to import connections from a CSV file.","Notes":"<h2><strong>Dynamic Folder sample for CSV</strong></h2>\n\n<p><strong>Version</strong>: 1.0<br />\n<strong>Author</strong>: Royal Applications</p>\n\n<p>This Dynamic Folder sample for CSV files allows you to import connections from a CSV file.</p>\n\n<h3><strong>Setup</strong></h3>\n\n<ul>\n\t<li>Enter the path to your CSV file in the &quot;CSV Path&quot; field in the &quot;Custom Properties&quot; section.</li>\n</ul>\n","CustomProperties":[{"Name":"CSV Path","Type":"URL","Value":"TODO"}],"ScriptInterpreter":"powershell","DynamicCredentialScriptInterpreter":"json","Script":"$ErrorActionPreference = \"Stop\"\n\n$computers = Import-Csv \"$CustomProperty.CSVPath$\"\n\n$connections = @()\n\nForEach ($computer in $computers) {\n    $name = $computer.Name\n    $computerName = $computer.ComputerName\n    $username = $computer.Username\n    $password = $computer.Password\n\n    $connection = New-Object pscustomobject -Property @{\n        \"Type\" = \"TerminalConnection\";\n        \"TerminalConnectionType\" = \"SSH\";\n        \"Name\" = $name;\n        \"ComputerName\" = $computerName;\n        \"Username\" = $username;\n        \"Password\" = $password;\n    }\n\n    $connections += $connection\n}\n\n@{\n    Objects = $connections\n} |\nConvertTo-Json -Depth 100 |\nWrite-Host"}]}