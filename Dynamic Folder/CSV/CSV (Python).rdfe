{"Name":"Dynamic Folder Export","Objects":[{"Type":"DynamicFolder","Name":"CSV (Python)","Description": "This Dynamic Folder sample for CSV files allows you to import connections from a CSV file.","Notes":"<h2><strong>Dynamic Folder sample for CSV</strong></h2>\n\n<p><strong>Version</strong>: 1.0<br />\n<strong>Author</strong>: Royal Applications</p>\n\n<p>This Dynamic Folder sample for CSV files allows you to import connections from a CSV file.</p>\n\n<h3><strong>Setup</strong></h3>\n\n<ul>\n\t<li>Enter the path to your CSV file in the &quot;CSV Path&quot; field in the &quot;Custom Properties&quot; section.</li>\n</ul>\n","CustomProperties":[{"Name":"CSV Path","Type":"URL","Value":"TODO"}],"ScriptInterpreter":"python","DynamicCredentialScriptInterpreter":"json","Script":"import os\nimport csv\nimport json\n\ndef get_entries(csv_path):\n    csvfile = open(os.path.expanduser(csv_path))\n    reader = csv.DictReader(csvfile)\n\n    connections = []\n\n    for row in reader:\n        name = row[\"Name\"]\n        computerName = row[\"ComputerName\"]\n        username = row[\"Username\"]\n        password = row[\"Password\"]\n\n        connection = {\n            \"Type\": \"TerminalConnection\",\n            \"TerminalConnectionType\": \"SSH\",\n            \"Name\": name,\n            \"ComputerName\": computerName,\n            \"Username\": username,\n            \"Password\": password\n        }\n\n        connections.append(connection)\n\n    store = {\n        \"Objects\": connections\n    }\n\n    store_json = json.dumps(store)\n\n    return store_json\n\nprint(get_entries(\"$CustomProperty.CSVPath$\"))"}]}